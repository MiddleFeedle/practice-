{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\1\\\\Desktop\\\\practice\\\\src\\\\pages\\\\articles.js\";\nimport React from 'react';\nimport * as firebase from 'firebase';\nimport './articles.css';\nimport Addbutton from './addbutton';\nimport RightBar from './rightbar';\n\nclass Articles extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      postinfo: [],\n      edit: false\n    };\n    this.delete = this.delete.bind(this);\n  }\n\n  delete(title) {\n    alert(title);\n    const db = firebase.database();\n    const path = \"postinfo/1\";\n    const postdata = db.ref(path);\n    postdata.remove();\n    var storageRef = firebase.storage().ref();\n    var ref = storageRef.child('images/' + title);\n    ref.delete().then(function () {// File deleted successfully\n    }).catch(function (error) {// Uh-oh, an error occurred!\n    });\n  }\n\n  componentDidMount() {\n    let newState = [];\n    let db = firebase.database();\n    const postdata = db.ref('postinfo');\n    postdata.on('value', snapshot => {\n      let posts = snapshot.val();\n\n      for (let post in posts) {\n        newState.push({\n          id: post,\n          title: posts[post].title,\n          maintext: posts[post].maintext,\n          date: posts[post].date,\n          jsdate: posts[post].jsdate\n        });\n      }\n\n      this.setState({\n        postinfo: newState\n      });\n    });\n    const app = firebase.app();\n    db = firebase.firestore();\n    const admin = db.collection('admins');\n    firebase.auth().onAuthStateChanged(user => {\n      if (user) {\n        var query = null;\n        query = admin.where(\"id\", \"==\", user.uid);\n\n        if (query != null) {\n          this.setState({\n            edit: true\n          });\n        }\n      }\n    });\n  }\n\n  render() {\n    const myData = [].concat(this.state.postinfo).sort((a, b) => a.jsdate < b.jsdate ? 1 : -1);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(Addbutton, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 3\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-8 maindiv\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 1\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"newsbar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      border: \"1\",\n      className: \"newstable\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"caption\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 1\n      }\n    }, \"\\u041F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u0438\\u0435 \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438 \\u043D\\u0430 \\u0441\\u0430\\u0439\\u0442\\u0435:\"), myData.map(postinfo => {\n      if (this.state.edit == false) {\n        return /*#__PURE__*/React.createElement(\"tr\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"th\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 29\n          }\n        }, postinfo.date)), /*#__PURE__*/React.createElement(\"th\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"a\", {\n          href: '/articles/' + postinfo.id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 29\n          }\n        }, postinfo.title)));\n      } else {\n        return /*#__PURE__*/React.createElement(\"tr\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"th\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 29\n          }\n        }, postinfo.date)), /*#__PURE__*/React.createElement(\"th\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"a\", {\n          href: '/articles/' + postinfo.id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 29\n          }\n        }, postinfo.title)), /*#__PURE__*/React.createElement(\"th\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"a\", {\n          href: '/edit/' + postinfo.id,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 29\n          }\n        }, \"\\u0420\\u0435\\u0434\\u0430\\u043A\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\")), /*#__PURE__*/React.createElement(\"th\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          onClick: this.delete(postinfo.title),\n          className: \"btn btn-primary\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 29\n          }\n        }, \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\")));\n      }\n    })))), /*#__PURE__*/React.createElement(RightBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 3\n      }\n    }));\n  }\n\n}\n\nexport default Articles;","map":{"version":3,"sources":["C:/Users/1/Desktop/practice/src/pages/articles.js"],"names":["React","firebase","Addbutton","RightBar","Articles","Component","constructor","props","state","postinfo","edit","delete","bind","title","alert","db","database","path","postdata","ref","remove","storageRef","storage","child","then","catch","error","componentDidMount","newState","on","snapshot","posts","val","post","push","id","maintext","date","jsdate","setState","app","firestore","admin","collection","auth","onAuthStateChanged","user","query","where","uid","render","myData","concat","sort","a","b","map"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport * as firebase from 'firebase';\r\n\r\nimport './articles.css';\r\n\r\nimport Addbutton from './addbutton'\r\nimport RightBar from './rightbar'\r\n\r\nclass Articles extends React.Component\r\n{\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      postinfo: [],\r\n      edit: false\r\n    };\r\n\r\n    this.delete = this.delete.bind(this);\r\n\r\n  }\r\n\r\n  delete(title)\r\n  {\r\n    alert(title);\r\n    const db = firebase.database();\r\n    const path = \"postinfo/1\";\r\n    const postdata = db.ref(path);\r\n    postdata.remove();\r\n\r\n    var storageRef = firebase.storage().ref();\r\n\r\n    var ref = storageRef.child('images/'+title);\r\n\r\n  ref.delete().then(function() {\r\n\r\n\r\n  // File deleted successfully\r\n}).catch(function(error) {\r\n\r\n\r\n  // Uh-oh, an error occurred!\r\n});\r\n\r\n\r\n  }\r\n\r\n  componentDidMount() {\r\n    let newState = [];\r\n    let db = firebase.database();\r\n    const postdata = db.ref('postinfo');\r\n\r\n    postdata.on('value', (snapshot) =>\r\n    {\r\n        let posts = snapshot.val();\r\n        for(let post in posts)\r\n        {\r\n          newState.push({\r\n            id: post,\r\n            title: posts[post].title,\r\n            maintext: posts[post].maintext,\r\n            date: posts[post].date,\r\n            jsdate: posts[post].jsdate\r\n          });\r\n        }\r\n\r\nthis.setState({\r\n  postinfo: newState\r\n});\r\n});\r\n\r\n\r\n\r\nconst app = firebase.app();\r\ndb = firebase.firestore();\r\nconst admin = db.collection('admins');\r\n\r\n\r\nfirebase.auth().onAuthStateChanged(user => {\r\n     if (user)\r\n     {\r\n      var query = null;\r\n      query = admin.where(\"id\", \"==\", user.uid);\r\n\r\n          if(query != null)\r\n           {\r\n             this.setState({\r\n                edit: true\r\n             });\r\n          }\r\n }});\r\n\r\n    }\r\n\r\n\r\n  render()\r\n  {\r\n\r\n    const myData = [].concat(this.state.postinfo)\r\n   .sort((a, b) => a.jsdate < b.jsdate ? 1 : -1);\r\n\r\n\r\n    return (\r\n<div className = \"row\">\r\n  <Addbutton />\r\n\r\n\r\n<div className = \"col-md-8 maindiv\">\r\n      <div className = \"newsbar\">\r\n      <table border=\"1\" className = \"newstable\">\r\n<caption>Последние новости на сайте:</caption>\r\n\r\n          {\r\n\r\n    myData.map((postinfo) => {\r\n            if(this.state.edit == false)\r\n            {\r\n              return(\r\n                <tr>\r\n                        <th><p>{postinfo.date}</p></th>\r\n                        <th><a href={'/articles/'+postinfo.id}>{postinfo.title}</a></th>\r\n                </tr>\r\n              )\r\n            }\r\n            else\r\n            {\r\n              return(\r\n                <tr>\r\n                        <th><p>{postinfo.date}</p></th>\r\n                        <th><a href={'/articles/'+postinfo.id}>{postinfo.title}</a></th>\r\n                        <th><a href={'/edit/'+postinfo.id}>Редактировать</a></th>\r\n                        <th><button onClick={this.delete(postinfo.title)} className=\"btn btn-primary\">Удалить</button></th>\r\n\r\n                </tr>\r\n              )\r\n\r\n            }\r\n          })}\r\n        </table>\r\n      </div>\r\n  </div>\r\n  <RightBar />\r\n  </div>\r\n\r\n    );\r\n\r\n  }\r\n\r\n}\r\n\r\n\r\nexport default Articles;\r\n"]},"metadata":{},"sourceType":"module"}